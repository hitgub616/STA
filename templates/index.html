<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ì‹ ê¸°ìˆ ì  ë¶„ì„ ì‹œìŠ¤í…œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #1e293b;
            --light-color: #f8fafc;
        }

        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin: 2rem auto;
            max-width: 1200px;
        }

        .header {
            background: linear-gradient(135deg, var(--dark-color), #334155);
            color: white;
            padding: 2rem;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }

        .search-section {
            padding: 2rem;
            background: var(--light-color);
        }

        .analysis-section {
            padding: 2rem;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .signal-card {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-left: 4px solid var(--primary-color);
        }

        .signal-neutral {
            border-left-color: var(--secondary-color);
        }

        .signal-buy {
            border-left-color: var(--success-color);
        }

        .signal-sell {
            border-left-color: var(--danger-color);
        }

        .signal-trending {
            border-left-color: var(--warning-color);
        }

        .expert-summary {
            background: linear-gradient(135deg, #1e293b, #334155);
            color: white;
            border-radius: 15px;
            padding: 2rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .popular-symbols {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .symbol-tag {
            background: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .symbol-tag:hover {
            background: #1d4ed8;
            transform: scale(1.05);
        }

        .price-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .indicator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .strategy-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .strategy-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--success-color);
        }

        .strategy-card.holder {
            border-left-color: var(--primary-color);
        }

        .strategy-card.non-holder {
            border-left-color: var(--warning-color);
        }

        .signal-insufficient {
            border-left: 4px solid #ffc107;
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.05));
        }
        
        .signal-insufficient .card-title {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="main-container">
            <!-- í—¤ë” -->
            <div class="header">
                <h1><i class="fas fa-chart-line"></i> ì£¼ì‹ ê¸°ìˆ ì  ë¶„ì„ ì‹œìŠ¤í…œ</h1>
                <p class="mb-0">AI ê¸°ë°˜ ì „ë¬¸ê°€ ë¶„ì„ìœ¼ë¡œ ìŠ¤ë§ˆíŠ¸í•œ íˆ¬ì ê²°ì •ì„ ë„ì™€ë“œë¦½ë‹ˆë‹¤</p>
            </div>

            <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
            <div class="search-section">
                <div class="row">
                    <div class="col-md-6">
                        <label for="symbolInput" class="form-label fw-bold">ì£¼ì‹ ì‹¬ë³¼</label>
                        <div class="input-group">
                            <input type="text" class="form-control form-control-lg" id="symbolInput" 
                                   placeholder="ì˜ˆ: AAPL, GOOGL, TSLA" value="AAPL">
                            <button class="btn btn-primary btn-lg" type="button" onclick="analyzeStock()">
                                <i class="fas fa-search"></i> ë¶„ì„í•˜ê¸°
                            </button>
                        </div>
                        
                        <div class="popular-symbols">
                            <small class="text-muted me-2">ì¸ê¸° ì£¼ì‹:</small>
                            <span class="symbol-tag" onclick="setSymbol('AAPL')">AAPL</span>
                            <span class="symbol-tag" onclick="setSymbol('GOOGL')">GOOGL</span>
                            <span class="symbol-tag" onclick="setSymbol('MSFT')">MSFT</span>
                            <span class="symbol-tag" onclick="setSymbol('TSLA')">TSLA</span>
                            <span class="symbol-tag" onclick="setSymbol('NVDA')">NVDA</span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="periodSelect" class="form-label fw-bold">ë¶„ì„ ê¸°ê°„</label>
                        <select class="form-select form-select-lg" id="periodSelect">
                            <option value="1mo">1ê°œì›”</option>
                            <option value="3mo">3ê°œì›”</option>
                            <option value="6mo">6ê°œì›”</option>
                            <option value="1y" selected>1ë…„</option>
                            <option value="2y">2ë…„</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- ë¡œë”© -->
            <div class="loading" id="loading">
                <div class="spinner mx-auto mb-3"></div>
                <h5>AIê°€ ì£¼ì‹ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</h5>
                <p class="text-muted">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”</p>
            </div>

            <!-- ë¶„ì„ ê²°ê³¼ ì„¹ì…˜ -->
            <div class="analysis-section" id="analysisSection" style="display: none;">
                <!-- ì£¼ì‹ ê¸°ë³¸ ì •ë³´ -->
                <div class="card mb-4">
                    <div class="card-body text-center">
                        <h2 id="stockSymbol" class="mb-3"></h2>
                        <div class="price-display" id="stockPrice"></div>
                        <p class="text-muted" id="analysisDate"></p>
                    </div>
                </div>

                <!-- ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ -->
                <div class="expert-summary mb-4">
                    <div id="expertSummary" style="font-size: 1.1em; line-height: 1.6;"></div>
                </div>

                <!-- íˆ¬ììë³„ ì „ëµ -->
                <div class="strategy-section">
                    <h4><i class="fas fa-users"></i> íˆ¬ììë³„ ì „ëµ ì œì•ˆ</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="strategy-card non-holder">
                                <h5><i class="fas fa-user-plus"></i> ì£¼ì‹ ë¯¸ë³´ìœ ì</h5>
                                <div id="nonHolderStrategy"></div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="strategy-card holder">
                                <h5><i class="fas fa-user-check"></i> ì£¼ì‹ ë³´ìœ ì</h5>
                                <div id="holderStrategy"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ê¸°ìˆ ì  ì§€í‘œ -->
                <div class="mt-4">
                    <h4><i class="fas fa-chart-bar"></i> ê¸°ìˆ ì  ì§€í‘œ ë¶„ì„</h4>
                    <div class="indicator-grid" id="indicatorGrid"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function setSymbol(symbol) {
            document.getElementById('symbolInput').value = symbol;
        }

        function analyzeStock() {
            const symbol = document.getElementById('symbolInput').value.trim().toUpperCase();
            const period = document.getElementById('periodSelect').value;
            
            if (!symbol) {
                alert('ì£¼ì‹ ì‹¬ë³¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¡œë”© í‘œì‹œ
            document.getElementById('loading').style.display = 'block';
            document.getElementById('analysisSection').style.display = 'none';

            // API í˜¸ì¶œ
            fetch('/analyze', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    symbol: symbol,
                    period: period
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + data.error);
                    return;
                }
                displayResults(data);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            })
            .finally(() => {
                document.getElementById('loading').style.display = 'none';
            });
        }

        function displayResults(data) {
            // ê¸°ë³¸ ì •ë³´ í‘œì‹œ
            document.getElementById('stockSymbol').textContent = data.symbol;
            document.getElementById('stockPrice').textContent = `$${parseFloat(data.stock_info.latest_price).toFixed(2)}`;
            document.getElementById('analysisDate').textContent = `ë¶„ì„ì¼: ${data.analysis_date}`;

            // ì¢…í•© ì¶”ì²œ í‘œì‹œ
            const recommendation = data.recommendation || 'HOLD';
            const totalScore = data.total_score || 0;
            const recommendationText = getRecommendationText(recommendation);
            const scoreColor = getScoreColor(totalScore);
            
            document.getElementById('stockSymbol').innerHTML = `
                ${data.symbol}
                <div class="recommendation-badge" style="background: ${scoreColor}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8em; margin-top: 8px; display: inline-block;">
                    ${recommendationText} (ì ìˆ˜: ${totalScore})
                </div>
            `;

            // ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ ì „ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ (íŒŒì‹± ì—†ì´)
            const summary = data.expert_summary;
            const summaryHtml = summary.replace(/\n/g, '<br>');
            document.getElementById('expertSummary').innerHTML = `
                <div class="expert-summary-text">
                    <pre style="white-space: pre-wrap; font-family: inherit; margin: 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; line-height: 1.6; color: white;">${summaryHtml}</pre>
                </div>
            `;
            
            // íˆ¬ììë³„ ì „ëµ ì œì•ˆ ì„¹ì…˜ ìˆ¨ê¸°ê¸° (ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ì— í¬í•¨ë¨)
            document.querySelector('.strategy-section').style.display = 'none';

            // ê¸°ìˆ ì  ì§€í‘œ í‘œì‹œ (ì ìˆ˜ í¬í•¨)
            displayIndicators(data.interpreted_signals, data.scores);

            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            document.getElementById('analysisSection').style.display = 'block';
        }

        function parseExpertSummary(summary) {
            const parts = {
                summary: '',
                nonHolder: '',
                holder: ''
            };

            console.log('Parsing summary:', summary);

            // ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ ì¶”ì¶œ
            let summaryText = '';
            
            // ë°©ë²• 1: ì •í™•í•œ í˜•ì‹ ë§¤ì¹­ (í°ë”°ì˜´í‘œ ì—†ì´)
            const summaryMatch = summary.match(/ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:\s*\n\n([\s\S]*?)(?=\n\nğŸ“ˆ|$)/);
            if (summaryMatch) {
                summaryText = summaryMatch[1].trim();
            } else {
                // ë°©ë²• 2: ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ ë‹¤ìŒ í…ìŠ¤íŠ¸ ì°¾ê¸°
                const summaryIndex = summary.indexOf('ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:');
                if (summaryIndex !== -1) {
                    const afterSummary = summary.substring(summaryIndex);
                    const nextSectionIndex = afterSummary.indexOf('ğŸ“ˆ íˆ¬ììë³„ ì „ëµ ì œì•ˆ:');
                    if (nextSectionIndex !== -1) {
                        summaryText = afterSummary.substring(afterSummary.indexOf('\n\n') + 2, nextSectionIndex).trim();
                    } else {
                        summaryText = afterSummary.substring(afterSummary.indexOf('\n\n') + 2).trim();
                    }
                }
            }
            
            parts.summary = summaryText;

            // ë¯¸ë³´ìœ ì ì „ëµ ì¶”ì¶œ (í°ë”°ì˜´í‘œ ì—†ì´)
            let nonHolderText = '';
            const nonHolderMatch = summary.match(/ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:\s*\n([^\n]+)/);
            if (nonHolderMatch) {
                nonHolderText = nonHolderMatch[1].trim();
            } else {
                // ëŒ€ì²´ ë°©ë²•: ë¯¸ë³´ìœ ì ì„¹ì…˜ ì°¾ê¸°
                const nonHolderIndex = summary.indexOf('ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:');
                if (nonHolderIndex !== -1) {
                    const afterNonHolder = summary.substring(nonHolderIndex);
                    const nextLineIndex = afterNonHolder.indexOf('\n', afterNonHolder.indexOf('\n') + 1);
                    if (nextLineIndex !== -1) {
                        nonHolderText = afterNonHolder.substring(afterNonHolder.indexOf('\n') + 1, nextLineIndex).trim();
                    } else {
                        nonHolderText = afterNonHolder.substring(afterNonHolder.indexOf('\n') + 1).trim();
                    }
                }
            }
            
            parts.nonHolder = nonHolderText;

            // ë³´ìœ ì ì „ëµ ì¶”ì¶œ (í°ë”°ì˜´í‘œ ì—†ì´)
            let holderText = '';
            const holderMatch = summary.match(/ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:\s*\n([^\n]+)/);
            if (holderMatch) {
                holderText = holderMatch[1].trim();
            } else {
                // ëŒ€ì²´ ë°©ë²•: ë³´ìœ ì ì„¹ì…˜ ì°¾ê¸°
                const holderIndex = summary.indexOf('ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:');
                if (holderIndex !== -1) {
                    const afterHolder = summary.substring(holderIndex);
                    const nextLineIndex = afterHolder.indexOf('\n', afterHolder.indexOf('\n') + 1);
                    if (nextLineIndex !== -1) {
                        holderText = afterHolder.substring(afterHolder.indexOf('\n') + 1, nextLineIndex).trim();
                    } else {
                        holderText = afterHolder.substring(afterHolder.indexOf('\n') + 1).trim();
                    }
                }
            }
            
            parts.holder = holderText;

            // íŒŒì‹± ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²•: ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ì„¹ì…˜ë³„ë¡œ ë¶„í• 
            if (!parts.summary || !parts.nonHolder || !parts.holder) {
                console.log('Primary parsing failed, trying alternative method...');
                
                const lines = summary.split('\n');
                let currentSection = '';
                let summaryLines = [];
                let nonHolderLines = [];
                let holderLines = [];
                
                for (let line of lines) {
                    line = line.trim();
                    if (line.includes('ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:')) {
                        currentSection = 'summary';
                        continue;
                    } else if (line.includes('ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:')) {
                        currentSection = 'nonHolder';
                        continue;
                    } else if (line.includes('ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:')) {
                        currentSection = 'holder';
                        continue;
                    } else if (line.includes('ğŸ“ˆ íˆ¬ììë³„ ì „ëµ ì œì•ˆ:')) {
                        currentSection = '';
                        continue;
                    }
                    
                    if (line && currentSection === 'summary') {
                        summaryLines.push(line);
                    } else if (line && currentSection === 'nonHolder') {
                        nonHolderLines.push(line);
                    } else if (line && currentSection === 'holder') {
                        holderLines.push(line);
                    }
                }
                
                if (!parts.summary && summaryLines.length > 0) {
                    parts.summary = summaryLines.join(' ');
                }
                if (!parts.nonHolder && nonHolderLines.length > 0) {
                    parts.nonHolder = nonHolderLines.join(' ');
                }
                if (!parts.holder && holderLines.length > 0) {
                    parts.holder = holderLines.join(' ');
                }
            }

            console.log('Final parsed parts:', parts);
            return parts;
        }

        function displayIndicators(interpretedSignals, scores) {
            const grid = document.getElementById('indicatorGrid');
            grid.innerHTML = '';

            Object.entries(interpretedSignals).forEach(([key, indicator]) => {
                const signalClass = getSignalClass(indicator.signal);
                const icon = getSignalIcon(indicator.signal);
                const score = scores[key] || 0;
                const scoreColor = getScoreColor(score);
                
                const card = document.createElement('div');
                card.className = `card signal-card ${signalClass}`;
                card.innerHTML = `
                    <div class="card-body">
                        <div class="indicator-header d-flex justify-content-between align-items-start mb-3">
                            <div class="d-flex align-items-center">
                                <i class="${icon} me-2"></i>
                                <div>
                                    <h6 class="card-title mb-1">${indicator.indicator_name}</h6>
                                    <small class="text-muted">${indicator.type}</small>
                                </div>
                            </div>
                            <span class="score-badge" style="background: ${scoreColor}; color: white; padding: 4px 8px; border-radius: 12px; font-weight: bold; font-size: 0.9em;">
                                ${score > 0 ? '+' : ''}${score}
                            </span>
                        </div>
                        
                        <div class="indicator-description mb-3">
                            <p class="text-muted small mb-0">${getIndicatorDescription(key)}</p>
                        </div>
                        
                        <div class="indicator-result">
                            <div class="result-label small text-muted mb-1">ë¶„ì„ ê²°ê³¼:</div>
                            <div class="result-value ${signalClass}" style="font-weight: bold; font-size: 1.1em; padding: 8px 12px; border-radius: 8px; background: ${getSignalBackgroundColor(signalClass)};">
                                ${indicator.description}
                            </div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function getIndicatorDescription(indicator) {
            const descriptions = {
                'RSI': 'ì£¼ê°€ê°€ ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ìƒíƒœì¸ì§€ íŒë‹¨',
                'MACD': 'ë‹¨ê¸°/ì¥ê¸° ì´ë™í‰ê· ì˜ ì°¨ì´ë¡œ ì¶”ì„¸ ë°©í–¥ í™•ì¸',
                'MA_CROSSOVER': 'ë‹¨ê¸°/ì¥ê¸° ì´ë™í‰ê·  êµì°¨ë¡œ ì¶”ì„¸ ì „í™˜ ê°ì§€',
                'ADX': 'í˜„ì¬ ì¶”ì„¸ê°€ ì–¼ë§ˆë‚˜ ê°•í•œì§€ ì¸¡ì •',
                'BREAKOUT': 'ì£¼ìš” ì €í•­/ì§€ì§€ì„  ëŒíŒŒ ì—¬ë¶€ í™•ì¸',
                'ATR': 'ì£¼ê°€ì˜ ë³€ë™ì„±ì´ ì–¼ë§ˆë‚˜ í°ì§€ ì¸¡ì •',
                'VWAP': 'ê±°ë˜ëŸ‰ì„ ê³ ë ¤í•œ ê³µì •ê°€ì¹˜ ëŒ€ë¹„ í˜„ì¬ê°€ ìœ„ì¹˜'
            };
            return descriptions[indicator] || 'ê¸°ìˆ ì  ë¶„ì„ ì§€í‘œ';
        }

        function getSignalBackgroundColor(signalClass) {
            const colors = {
                'signal-buy': 'rgba(40, 167, 69, 0.1)',
                'signal-sell': 'rgba(220, 53, 69, 0.1)',
                'signal-trending': 'rgba(255, 193, 7, 0.1)',
                'signal-neutral': 'rgba(108, 117, 125, 0.1)',
                'signal-insufficient': 'rgba(255, 193, 7, 0.1)'
            };
            return colors[signalClass] || 'rgba(108, 117, 125, 0.1)';
        }

        function getSignalClass(signal) {
            if (signal.includes('STRONG_BUY') || signal.includes('STRONG_BULLISH') || signal.includes('STRONG_GOLDEN') || signal.includes('STRONG_BREAKOUT') || signal.includes('STRONG_VOLATILITY') || signal.includes('STRONG_UNDER') || signal.includes('STRONG_OVERSOLD')) {
                return 'signal-buy';
            } else if (signal.includes('WEAK_BUY') || signal.includes('WEAK_BULLISH') || signal.includes('WEAK_GOLDEN') || signal.includes('WEAK_BREAKOUT') || signal.includes('WEAK_VOLATILITY') || signal.includes('WEAK_UNDER') || signal.includes('WEAK_OVERSOLD')) {
                return 'signal-buy';
            } else if (signal.includes('STRONG_SELL') || signal.includes('STRONG_BEARISH') || signal.includes('STRONG_DEAD') || signal.includes('STRONG_BREAKDOWN') || signal.includes('STRONG_STABILITY') || signal.includes('STRONG_OVER') || signal.includes('STRONG_OVERBOUGHT')) {
                return 'signal-sell';
            } else if (signal.includes('WEAK_SELL') || signal.includes('WEAK_BEARISH') || signal.includes('WEAK_DEAD') || signal.includes('WEAK_BREAKDOWN') || signal.includes('WEAK_STABILITY') || signal.includes('WEAK_OVER') || signal.includes('WEAK_OVERBOUGHT')) {
                return 'signal-sell';
            } else if (signal.includes('TREND') || signal.includes('STRONG_TREND') || signal.includes('WEAK_TREND')) {
                return 'signal-trending';
            } else if (signal.includes('INSUFFICIENT_DATA')) {
                return 'signal-insufficient';
            }
            return 'signal-neutral';
        }

        function getSignalIcon(signal) {
            if (signal.includes('STRONG_BUY') || signal.includes('STRONG_BULLISH') || signal.includes('STRONG_GOLDEN') || signal.includes('STRONG_BREAKOUT') || signal.includes('STRONG_VOLATILITY') || signal.includes('STRONG_UNDER') || signal.includes('STRONG_OVERSOLD')) {
                return 'fas fa-arrow-up text-success';
            } else if (signal.includes('WEAK_BUY') || signal.includes('WEAK_BULLISH') || signal.includes('WEAK_GOLDEN') || signal.includes('WEAK_BREAKOUT') || signal.includes('WEAK_VOLATILITY') || signal.includes('WEAK_UNDER') || signal.includes('WEAK_OVERSOLD')) {
                return 'fas fa-arrow-up text-info';
            } else if (signal.includes('STRONG_SELL') || signal.includes('STRONG_BEARISH') || signal.includes('STRONG_DEAD') || signal.includes('STRONG_BREAKDOWN') || signal.includes('STRONG_STABILITY') || signal.includes('STRONG_OVER') || signal.includes('STRONG_OVERBOUGHT')) {
                return 'fas fa-arrow-down text-danger';
            } else if (signal.includes('WEAK_SELL') || signal.includes('WEAK_BEARISH') || signal.includes('WEAK_DEAD') || signal.includes('WEAK_BREAKDOWN') || signal.includes('WEAK_STABILITY') || signal.includes('WEAK_OVER') || signal.includes('WEAK_OVERBOUGHT')) {
                return 'fas fa-arrow-down text-warning';
            } else if (signal.includes('TREND') || signal.includes('STRONG_TREND') || signal.includes('WEAK_TREND')) {
                return 'fas fa-chart-line text-warning';
            } else if (signal.includes('INSUFFICIENT_DATA')) {
                return 'fas fa-exclamation-triangle text-warning';
            }
            return 'fas fa-minus text-secondary';
        }

        function getRecommendationText(recommendation) {
            const texts = {
                'STRONG_BUY': 'ê°•ë ¥ ë§¤ìˆ˜',
                'BUY': 'ë§¤ìˆ˜',
                'HOLD': 'ê´€ë§',
                'SELL': 'ë§¤ë„',
                'STRONG_SELL': 'ê°•ë ¥ ë§¤ë„'
            };
            return texts[recommendation] || 'ê´€ë§';
        }

        function getScoreColor(score) {
            if (score >= 3) return '#28a745'; // ê°•ë ¥ ë§¤ìˆ˜ - ì´ˆë¡
            if (score >= 1) return '#17a2b8'; // ë§¤ìˆ˜ - íŒŒë‘
            if (score <= -3) return '#dc3545'; // ê°•ë ¥ ë§¤ë„ - ë¹¨ê°•
            if (score <= -1) return '#fd7e14'; // ë§¤ë„ - ì£¼í™©
            return '#6c757d'; // ê´€ë§ - íšŒìƒ‰
        }

        // Enter í‚¤ë¡œ ë¶„ì„ ì‹¤í–‰
        document.getElementById('symbolInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeStock();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ë¶„ì„ ì‹¤í–‰
        window.addEventListener('load', function() {
            analyzeStock();
        });
    </script>
</body>
</html> 