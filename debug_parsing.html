<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT íŒŒì‹± ë””ë²„ê¹…</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .input { width: 100%; height: 200px; }
        .output { background: #f5f5f5; padding: 10px; border-radius: 5px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>ChatGPT ì‘ë‹µ íŒŒì‹± ë””ë²„ê¹…</h1>
    
    <div class="section">
        <h3>ChatGPT ì‘ë‹µ ì…ë ¥:</h3>
        <textarea class="input" id="chatgptResponse">
ğŸ§  ì „ë¬¸ê°€ì  ì¢…í•©í‰ê°€:

í˜„ì¬ AAPLì˜ ê¸°ìˆ ì  ì§€í‘œë“¤ì€ ëŒ€ë¶€ë¶„ ì¤‘ë¦½ì ì¸ ì‹ í˜¸ë¥¼ ë‚˜íƒ€ë‚´ê³  ìˆìœ¼ë©°, ADX ì§€í‘œì— ë”°ë¥´ë©´ ì‹œì¥ì€ íŠ¸ë Œë“œë¥¼ í˜•ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. OBVê°€ ëˆ„ì ë˜ëŠ” ëª¨ìŠµì„ ë³´ì´ê³  ìˆì–´ ë§¤ìˆ˜ì„¸ê°€ ì¡°ê¸ˆì”© ì¦ê°€í•˜ê³  ìˆëŠ” ê²ƒìœ¼ë¡œ íŒë‹¨ë˜ë©°, ì—˜ë¦¬ì—‡ íŒŒë™ ì´ë¡ ì—ì„œëŠ” ìƒìŠ¹ ì¶”ì„¸ì˜ ì¤‘ê°„ì¸ íŒŒë™ 3ì— ìœ„ì¹˜í•œ ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
                                       
ğŸ“ˆ íˆ¬ììë³„ ì „ëµ ì œì•ˆ:

ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:
ì§€ê¸ˆì€ í° ê°€ê²© ë³€ë™ì´ ì—†ëŠ” ìƒíƒœì´ë¯€ë¡œ ê´€ë§ì„ ì¶”ì²œí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë§¤ìˆ˜ì„¸ê°€ ì¦ê°€í•˜ê³  ìˆëŠ” ë§Œí¼, ì¶”ì„¸ê°€ ëª…í™•í•´ì§€ë©´ ë§¤ìˆ˜ ê¸°íšŒë¥¼ ë…¸ë ¤ë³´ì„¸ìš”.                                                                                  
ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:
í˜„ì¬ ë³´ìœ ë¥¼ ìœ ì§€í•˜ë©° ì¶”ì„¸ë¥¼ ì§€ì¼œë³´ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì‹œì¥ì´ ì•ˆì •ì ìœ¼ë¡œ ìƒìŠ¹í•˜ëŠ” ê²½ìš° ì¶”ê°€ ë§¤ìˆ˜ë¥¼ ê³ ë ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </textarea>
    </div>
    
    <button onclick="testParsing()">íŒŒì‹± í…ŒìŠ¤íŠ¸</button>
    
    <div class="section">
        <h3>íŒŒì‹± ê²°ê³¼:</h3>
        <div class="output" id="parsingResult"></div>
    </div>

    <script>
        function parseExpertSummary(summary) {
            const parts = {
                summary: '',
                nonHolder: '',
                holder: ''
            };

            console.log('Parsing summary:', summary);

            // ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ ì¶”ì¶œ
            let summaryText = '';
            
            // ë°©ë²• 1: ì •í™•í•œ í˜•ì‹ ë§¤ì¹­ (í°ë”°ì˜´í‘œ ì—†ì´)
            const summaryMatch = summary.match(/ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:\s*\n\n([\s\S]*?)(?=\n\nğŸ“ˆ|$)/);
            if (summaryMatch) {
                summaryText = summaryMatch[1].trim();
            } else {
                // ë°©ë²• 2: ì „ë¬¸ê°€ ì¢…í•©í‰ê°€ ë‹¤ìŒ í…ìŠ¤íŠ¸ ì°¾ê¸°
                const summaryIndex = summary.indexOf('ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:');
                if (summaryIndex !== -1) {
                    const afterSummary = summary.substring(summaryIndex);
                    const nextSectionIndex = afterSummary.indexOf('ğŸ“ˆ íˆ¬ììë³„ ì „ëµ ì œì•ˆ:');
                    if (nextSectionIndex !== -1) {
                        summaryText = afterSummary.substring(afterSummary.indexOf('\n\n') + 2, nextSectionIndex).trim();
                    } else {
                        summaryText = afterSummary.substring(afterSummary.indexOf('\n\n') + 2).trim();
                    }
                }
            }
            
            parts.summary = summaryText;

            // ë¯¸ë³´ìœ ì ì „ëµ ì¶”ì¶œ (í°ë”°ì˜´í‘œ ì—†ì´)
            let nonHolderText = '';
            const nonHolderMatch = summary.match(/ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:\s*\n([^\n]+)/);
            if (nonHolderMatch) {
                nonHolderText = nonHolderMatch[1].trim();
            } else {
                // ëŒ€ì²´ ë°©ë²•: ë¯¸ë³´ìœ ì ì„¹ì…˜ ì°¾ê¸°
                const nonHolderIndex = summary.indexOf('ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:');
                if (nonHolderIndex !== -1) {
                    const afterNonHolder = summary.substring(nonHolderIndex);
                    const nextLineIndex = afterNonHolder.indexOf('\n', afterNonHolder.indexOf('\n') + 1);
                    if (nextLineIndex !== -1) {
                        nonHolderText = afterNonHolder.substring(afterNonHolder.indexOf('\n') + 1, nextLineIndex).trim();
                    } else {
                        nonHolderText = afterNonHolder.substring(afterNonHolder.indexOf('\n') + 1).trim();
                    }
                }
            }
            
            parts.nonHolder = nonHolderText;

            // ë³´ìœ ì ì „ëµ ì¶”ì¶œ (í°ë”°ì˜´í‘œ ì—†ì´)
            let holderText = '';
            const holderMatch = summary.match(/ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:\s*\n([^\n]+)/);
            if (holderMatch) {
                holderText = holderMatch[1].trim();
            } else {
                // ëŒ€ì²´ ë°©ë²•: ë³´ìœ ì ì„¹ì…˜ ì°¾ê¸°
                const holderIndex = summary.indexOf('ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:');
                if (holderIndex !== -1) {
                    const afterHolder = summary.substring(holderIndex);
                    const nextLineIndex = afterHolder.indexOf('\n', afterHolder.indexOf('\n') + 1);
                    if (nextLineIndex !== -1) {
                        holderText = afterHolder.substring(afterHolder.indexOf('\n') + 1, nextLineIndex).trim();
                    } else {
                        holderText = afterHolder.substring(afterHolder.indexOf('\n') + 1).trim();
                    }
                }
            }
            
            parts.holder = holderText;

            // íŒŒì‹± ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²•: ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ì„¹ì…˜ë³„ë¡œ ë¶„í• 
            if (!parts.summary || !parts.nonHolder || !parts.holder) {
                console.log('Primary parsing failed, trying alternative method...');
                
                const lines = summary.split('\n');
                let currentSection = '';
                let summaryLines = [];
                let nonHolderLines = [];
                let holderLines = [];
                
                for (let line of lines) {
                    line = line.trim();
                    if (line.includes('ğŸ§  ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:')) {
                        currentSection = 'summary';
                        continue;
                    } else if (line.includes('ğŸ‘¤ ì£¼ì‹ ë¯¸ë³´ìœ ì:')) {
                        currentSection = 'nonHolder';
                        continue;
                    } else if (line.includes('ğŸ’¼ ì£¼ì‹ ë³´ìœ ì:')) {
                        currentSection = 'holder';
                        continue;
                    } else if (line.includes('ğŸ“ˆ íˆ¬ììë³„ ì „ëµ ì œì•ˆ:')) {
                        currentSection = '';
                        continue;
                    }
                    
                    if (line && currentSection === 'summary') {
                        summaryLines.push(line);
                    } else if (line && currentSection === 'nonHolder') {
                        nonHolderLines.push(line);
                    } else if (line && currentSection === 'holder') {
                        holderLines.push(line);
                    }
                }
                
                if (!parts.summary && summaryLines.length > 0) {
                    parts.summary = summaryLines.join(' ');
                }
                if (!parts.nonHolder && nonHolderLines.length > 0) {
                    parts.nonHolder = nonHolderLines.join(' ');
                }
                if (!parts.holder && holderLines.length > 0) {
                    parts.holder = holderLines.join(' ');
                }
            }

            console.log('Final parsed parts:', parts);
            return parts;
        }

        function testParsing() {
            const input = document.getElementById('chatgptResponse').value;
            const result = parseExpertSummary(input);
            
            document.getElementById('parsingResult').innerHTML = `
                <h4>íŒŒì‹± ê²°ê³¼:</h4>
                <p><strong>ì „ë¬¸ê°€ ì¢…í•©í‰ê°€:</strong> ${result.summary || 'íŒŒì‹± ì‹¤íŒ¨'}</p>
                <p><strong>ë¯¸ë³´ìœ ì ì „ëµ:</strong> ${result.nonHolder || 'íŒŒì‹± ì‹¤íŒ¨'}</p>
                <p><strong>ë³´ìœ ì ì „ëµ:</strong> ${result.holder || 'íŒŒì‹± ì‹¤íŒ¨'}</p>
            `;
        }
    </script>
</body>
</html> 